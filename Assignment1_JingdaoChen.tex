\documentclass[twoside,12pt]{article}
\usepackage{amsmath,amsfonts,amsthm,fullpage}
%\usepackage{mymath}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{graphicx}

\begin{document}

\title{CS 8803 DL Assigment 1}
\author{Jingdao Chen}
\date{Jan 26}
\maketitle
\openup 1em

\section{Problem 1}

The plot of the estimated linear function is shown below:

The plot of cost function vs. no. of iterations is shown below:

\section{Problem 2}

\subsection{Linear Layer}

Let the input be $x_0$ and the output be $x_1$. The linear layer is calculated as $x_1=w_1^Tx_0+b_1$.
\begin{equation}
\begin{split}
\frac{\partial E}{\partial w_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial w_1} \\
							    &= \frac{\partial E}{\partial x_1} x_0 \\
\frac{\partial E}{\partial b_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial b_1} \\
							    &= \frac{\partial E}{\partial x_1} \mathbf{1} 
\end{split}
\end{equation}

The plot of accuracy vs. no. of epoch is shown below:

\subsection{Linear-Sigmoid Layer}

Let the input be $x_0$ and the output be $x_2$. The linear layer is calculated as $x_1=w_1^Tx_0+b_1$.
The sigmoid layer is calculated as $x_2=\sigma(x_1)$.
\begin{equation}
\begin{split}
\frac{\partial E}{\partial x_1} &= \frac{\partial E}{\partial x_2} \frac{\partial x_2}{\partial x_1} \\
							    &= \frac{\partial E}{\partial x_2} (x_2) (1-x_2) \\
\frac{\partial E}{\partial w_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial w_1} \\
							    &= \frac{\partial E}{\partial x_1} x_0 \\
\frac{\partial E}{\partial b_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial b_1} \\
							    &= \frac{\partial E}{\partial x_1} \mathbf{1} 
\end{split}
\end{equation}

The plot of accuracy vs. no. of epoch is shown below:

\subsection{Linear-Sigmoid-Linear Layer}

Let the input be $x_0$ and the output be $x_3$. The first linear layer is calculated as $x_1=w_1^Tx_0+b_1$.
The sigmoid layer is calculated as $x_2=\sigma(x_1)$.
The second linear layer is calculated as $x_3=w_2^Tx_2+b_2$.
\begin{equation}
\begin{split}
\frac{\partial E}{\partial w_2} &= \frac{\partial E}{\partial x_3} \frac{\partial x_3}{\partial w_2} \\
							    &= \frac{\partial E}{\partial x_3} x_2 \\
\frac{\partial E}{\partial b_2} &= \frac{\partial E}{\partial x_3} \frac{\partial x_3}{\partial b_2} \\
							    &= \frac{\partial E}{\partial x_3} \mathbf{1} \\
\frac{\partial E}{\partial x_2} &= \frac{\partial E}{\partial x_3} \frac{\partial x_3}{\partial x_2} \\
								&= \frac{\partial E}{\partial x_3} w_2 \\
\frac{\partial E}{\partial x_1} &= \frac{\partial E}{\partial x_2} \frac{\partial x_2}{\partial x_1} \\
							    &= \frac{\partial E}{\partial x_2} (x_2) (1-x_2) \\
\frac{\partial E}{\partial w_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial w_1} \\
							    &= \frac{\partial E}{\partial x_1} x_0 \\
\frac{\partial E}{\partial b_1} &= \frac{\partial E}{\partial x_1} \frac{\partial x_1}{\partial b_1} \\
							    &= \frac{\partial E}{\partial x_1} \mathbf{1} 
\end{split}
\end{equation}

The plot of accuracy vs. no. of epoch is shown below:

\section{Gradient check}

One-sided finite difference approximation is calculated by:
\begin{equation}
\nabla J = \frac{J(\theta + \epsilon) - J(\theta)}{\epsilon}
\end{equation}
Two-sided finite difference approximation is calculated by:
\begin{equation}
\nabla J = \frac{J(\theta + \epsilon) - J(\theta - \epsilon)}{2 \epsilon}
\end{equation}

The two-sided version is more accurate because taking the linear approximation of $J(\theta)$
on both sides of $\theta$ evens out the error.


\end{document}
